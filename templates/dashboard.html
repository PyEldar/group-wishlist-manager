{% extends "base.html" %}
{% block content %}
<div class="group-info-banner">
    <h1>Rodina: {{ current_user.group.name }}</h1>
    <div class="invite-box">
        Pozvi ostatnÃ­ tÃ­mto kÃ³dem: <span class="code">{{ current_user.group.join_code }}</span>
    </div>
    <div class="invite-box">
        Nebo tÃ­mto odkazem: <span class="code">{{ url_for('index', code=current_user.group.join_code, _external=True) }}</span>
    </div>
</div>
<div class="my-section">
    <h2>ğŸ Moje pÅ™Ã¡nÃ­</h2>
    <form action="{{ url_for('add_wish') }}" method="POST" class="add-form">
        <input type="text" name="text" placeholder="Co si pÅ™ejeÅ¡?" required>
        <input type="text" name="url" placeholder="Odkaz (volitelnÃ©)">
        <button type="submit">PÅ™idat</button>
    </form>
    <ul class="wish-list">
        {% for wish in current_user.wishes %}
        <li>
            <div class="wish-info">
                <span class="wish-text">{{ wish.text }}</span>
                {% if wish.url %}
                    <a href="{{ wish.url if wish.url.startswith('http') else 'https://' + wish.url }}" target="_blank" class="link-icon">ğŸ”—</a>
                {% endif %}
            </div>
            <a href="{{ url_for('delete_wish', wish_id=wish.id) }}" class="delete-btn">Ã—</a>
        </li>
        {% else %}
        <p class="empty">ZatÃ­m sis nic nepÅ™Ã¡l(a).</p>
        {% endfor %}
    </ul>
</div>
<hr>
<h2>ğŸ… PÅ™Ã¡nÃ­ ostatnÃ­ch</h2>
<div class="family-grid">
    {% for user in users %}
        {% if user != current_user %}
        <div class="family-card">
            <h3>{{ user.display_name }}</h3>
            <ul class="wish-list">
                {% for wish in user.wishes %}
                <li class="{% if wish.reserved_by and wish.reserved_by != current_user.id %}taken{% endif %}">
                    <div class="wish-content">
                        <strong>{{ wish.text }}</strong>
                        {% if wish.url %}
                            <a href="{{ wish.url if wish.url.startswith('http') else 'https://' + wish.url }}" target="_blank">ğŸ”—</a>
                        {% endif %}
                    </div>
                    <div class="actions">
                        {% if wish.reserved_by == current_user.id %}
                            <a href="{{ url_for('toggle_reserve', wish_id=wish.id) }}" class="btn-reserved">âœ… Rezervovano</a>
                        {% elif wish.reserved_by %}
                            <span class="status-taken">ZabranÃ©</span>
                        {% else %}
                            <a href="{{ url_for('toggle_reserve', wish_id=wish.id) }}" class="btn-reserve">Rezervovat</a>
                        {% endif %}
                    </div>
                </li>
                {% else %}
                <p class="empty">ZatÃ­m nic.</p>
                {% endfor %}
            </ul>
        </div>
        {% endif %}
    {% endfor %}
</div>
{% endblock %}